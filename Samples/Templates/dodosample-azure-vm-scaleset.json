{
	"Variables": {
		"Name": "devopstestscaleset",
		"Subscription": "Dev Ops",
		"SubscriptionID": "e226e482-ce0f-47ea-8742-9bcce2fbfac9",
		"TenantID": "85703717-94e2-432b-b5fc-ed07887863c2",
		"ResourceGroupName": "test-resources",
		"ResourceGroupLocation": "Southeast Asia",
		"StorageAccount": "devopsteststore",
		"VirtualNetwork": "sample-arm-vnet01",
		"Subnet": "SampleSubnet",
		"DiagnosticsStorageAccountName": "devopsteststore",
		"LoadBalancerName": "devopsscaleset-lb"
	},
	"Containers": [
		{
			"Name": "Sample Storage Account",
			"Type": "AzureStorageAccount",
			"Attributes": {
				"Properties": {
					"Name": "[variables('StorageAccount')]",
					"IsClassic": "false",
					"Subscription": "[variables('Subscription')]",
					"SubscriptionID": "[variables('SubscriptionID')]",
					"TenantID": "[variables('TenantID')]",
					"Type": "Standard_GRS",
					"__comment": [
						"Supported Types",
						"Standard_LRS (Locally-redundant storage)",
						"Standard_ZRS (Zone-redundant storage)",
						"Standard_GRS (Geo-redundant storage)",
						"Standard_RAGRS (Read access geo-redundant storage)"
					]
				},
				"ResourceGroup": {
					"Name": "[variables('ResourceGroupName')]",
					"Location": "[variables('ResourceGroupLocation')]"
				}
			}
		},
		{
			"Name": "Sample VNET",
			"Type": "AzureVirtualNetwork",
			"Attributes": {
				"Properties": {
					"Name": "[variables('VirtualNetwork')]",
					"SubscriptionID": "[variables('SubscriptionID')]",
					"TenantID": "[variables('TenantID')]",
					"AddressPrefix": "192.168.0.0/16"
				},
				"ResourceGroup": {
					"Name": "[variables('ResourceGroupName')]",
					"Location": "[variables('ResourceGroupLocation')]"
				},
				"Subnets": [
					{
						"Name": "SampleSubnet",
						"AddressPrefix": "192.168.1.0/24",
						"NetworkSecurityGroup": "SampleSubnet-NSG"
					}
				],
				"NetworkSecurityGroups": [
					{
						"Name": "SampleSubnet-NSG",
						"Rules": [
							{
								"Name": "HTTP-Rule",
								"Description": "Allow HTTP Traffic",
								"Access": "Allow",
								"Protocol": "Tcp",
								"Direction": "Inbound",
								"Priority": "100",
								"SourceAddressPrefix": "125.7.50.82",
								"SourcePortRange": "*",
								"DestinationAddressPrefix": "*",
								"DestinationPortRange": "80"
							}
						],
						"Diagnostics": {
							"StorageAccountName": "[variables('DiagnosticsStorageAccountName')]",
							"ResourceGroupName": "[variables('ResourceGroupName')]",
							"RetentionEnabled": "true",
							"RetentionInDays": "30"
						}
					}
				]
			}
		},
		{
			"Name": "Sample External Loadbalancer",
			"Type": "AzureLoadBalancer",
			"Attributes": {
				"Properties": {
					"Name": "[variables('LoadBalancerName')]",
					"SubscriptionID": "[variables('SubscriptionID')]",
					"TenantID": "[variables('TenantID')]",
					"ResourceManagerProperties": {
						"frontendIPConfigurations": [
							{
								"name": "LoadBalancerFrontEnd",
								"properties": {
									"privateIPAllocationMethod": "Dynamic",
									"publicIPAddress": {
										"id": "/subscriptions/[variables('SubscriptionID')]/resourceGroups/[variables('ResourceGroupName')]/providers/Microsoft.Network/publicIPAddresses/[variables('LoadBalancerName')]-Pub-01"
									},
									"loadBalancingRules": [
										{
											"id": "/subscriptions/[variables('SubscriptionID')]/resourceGroups/[variables('ResourceGroupName')]/providers/Microsoft.Network/loadBalancers/[variables('LoadBalancerName')]/loadBalancingRules/HTTP-Inbound"
										}
									]
								}
							}
						],
						"backendAddressPools": [
							{
								"name": "[variables('LoadBalancerName')]-Backend",
								"properties": {
									"backendIPConfigurations": [
										{
											"id": "/subscriptions/[variables('SubscriptionID')]/resourceGroups/[variables('ResourceGroupName')]/providers/Microsoft.Network/networkInterfaces/[variables('LoadBalancerName')]-NIC-01/ipConfigurations/ipconfig1"
										}
									],
									"loadBalancingRules": [
										{
											"id": "/subscriptions/[variables('SubscriptionID')]/resourceGroups/[variables('ResourceGroupName')]/providers/Microsoft.Network/loadBalancers/[variables('LoadBalancerName')]/loadBalancingRules/HTTP-Inbound"
										}
									]
								}
							}
						],
						"loadBalancingRules": [
							{
								"name": "HTTP-Inbound",
								"id": "/subscriptions/[variables('SubscriptionID')]/resourceGroups/[variables('ResourceGroupName')]/providers/Microsoft.Network/loadBalancers/[variables('LoadBalancerName')]/loadBalancingRules/HTTP-Inbound",
								"properties": {
									"frontendIPConfiguration": {
										"id": "/subscriptions/[variables('SubscriptionID')]/resourceGroups/[variables('ResourceGroupName')]/providers/Microsoft.Network/loadBalancers/[variables('LoadBalancerName')]/frontendIPConfigurations/LoadBalancerFrontEnd"
									},
									"frontendPort": 80,
									"backendPort": 80,
									"enableFloatingIP": false,
									"idleTimeoutInMinutes": 4,
									"protocol": "Tcp",
									"loadDistribution": "Default",
									"backendAddressPool": {
										"id": "/subscriptions/[variables('SubscriptionID')]/resourceGroups/[variables('ResourceGroupName')]/providers/Microsoft.Network/loadBalancers/[variables('LoadBalancerName')]/backendAddressPools/[variables('LoadBalancerName')]-Backend"
									},
									"probe": {
										"id": "/subscriptions/[variables('SubscriptionID')]/resourceGroups/[variables('ResourceGroupName')]/providers/Microsoft.Network/loadBalancers/[variables('LoadBalancerName')]/probes/HTTP-Probe"
									}
								}
							}
						],
						"probes": [
							{
								"name": "HTTP-Probe",
								"id": "/subscriptions/[variables('SubscriptionID')]/resourceGroups/[variables('ResourceGroupName')]/providers/Microsoft.Network/loadBalancers/[variables('LoadBalancerName')]/probes/HTTP-Probe",
								"properties": {
									"protocol": "Http",
									"port": 80,
									"requestPath": "/",
									"intervalInSeconds": 5,
									"numberOfProbes": 2,
									"loadBalancingRules": [
										{
											"id": "/subscriptions/[variables('SubscriptionID')]/resourceGroups/[variables('ResourceGroupName')]/providers/Microsoft.Network/loadBalancers/[variables('LoadBalancerName')]/loadBalancingRules/HTTP-Inbound"
										}
									]
								}
							}
						],
						 
						"outboundNatRules": []
					},
					"PublicIPAddress": {
						"Name": "[variables('LoadBalancerName')]-Pub-01",
						"ResourceManagerProperties": {
							"publicIPAllocationMethod": "Static"
						}
					}
				},
				"InboundNATPools": [
					{
						"Name": "InboundNATPool01",
						"Protocol": "Tcp",
						"FrontEndPortRangeStart": "5000",
						"FrontEndPortRangeEnd": "5010",
						"BackEndPort": "3389"
					}
				],
				"ResourceGroup": {
					"Name": "[variables('ResourceGroupName')]",
					"Location": "[variables('ResourceGroupLocation')]"
				}
			}
		},
		{
			"Name": "Sample Virtual Machine Scale Set",
			"Type": "AzureVmScaleSet",
			"Attributes": {
				"Properties": {
					"Name": "[variables('Name')]",
					"SubscriptionID": "[variables('SubscriptionID')]",
					"TenantID": "[variables('TenantID')]",
					"Size": "Standard_A1",
					"UpgradePolicyMode": "manual",
					"SkuCapacity": 3,
					"__comment": [
						"Supported Sizes",
						"Standard_A0",
						"Basic_A0",
						"Standard_D1"
					],
					"Publisher": "MicrosoftWindowsServer",
					"Offer": "WindowsServer",
					"SKU": "2012-R2-Datacenter",
					"OSDiskName": "[variables('Name')]OSDisk",
					"StorageAccountName": "[variables('StorageAccount')]",
					"StorageProfileName": "[variables('Name')]storage",
					"Credential": {
						"Type": "Standard",
						"__comment": [
							"Supported Types",
							"Standard - Just a username and password",
							"PSCredentialPath - Fully qualified and escaped path to a PSCredential secure string file. IE C:\\AzurePassword.txt"
						],
						"Username": "webjet",
						"Password": "Webjet2016!"
					},
					"LoadbalancerBackendAddresspoolID": "/subscriptions/[variables('SubscriptionID')]/resourceGroups/[variables('ResourceGroupName')]/providers/Microsoft.Network/loadBalancers/[variables('LoadBalancerName')]/backendAddressPools/[variables('LoadBalancerName')]-Backend",
					"LoadbalancerInboundNATPoolID": "/subscriptions/[variables('SubscriptionID')]/resourceGroups/[variables('ResourceGroupName')]/providers/Microsoft.Network/loadBalancers/[variables('LoadBalancerName')]/inboundNatPools/InboundNATPool01",
					"ComputerName": "vmss",
					"PublicIPAddress": {
						"Name": "[variables('LoadBalancerName')]-Pub-01",
						"ResourceManagerProperties": {
							"publicIPAllocationMethod": "Static"
						}
					}
				},
				"ResourceGroup": {
					"Name": "[variables('ResourceGroupName')]",
					"Location": "[variables('ResourceGroupLocation')]"
				},
				"VirtualNetwork": {
					"Name": "[variables('VirtualNetwork')]",
					"ResourceGroupName": "[variables('ResourceGroupName')]",
					"SubnetName": "[variables('Subnet')]"
				}
			}
		}
	]
}